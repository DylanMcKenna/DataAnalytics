---
title: 'Assignment A02: TIDYVERSE'
author: DylanMcKenna
date: '2021-05-28'
slug: assignment-a02-tidyverse
categories:
  - tidyverse
tags: []
---


## Assignment 02: TIDYVERSE



## Timely Submission (2 points)


```{r echo=FALSE, message=FALSE, error=FALSE, warning= FALSE}
library(tidyverse)
library(dplyr)
library(convertr)

master <- read_csv("Master.csv")

batting <- read_csv("Batting.csv")

fielding <- read_csv("Fielding.csv")

master_name <- master %>%
  select(playerID, nameFirst, nameLast, bats, throws, birthCountry)
```

```{r}

batting <- batting %>%
  mutate( GIDP = as.double(GIDP),
      Avg. = H / AB)

head(batting)

fielding <- fielding %>%
  mutate( lgID = as.character(lgID))

head(master_name, 10)
head(fielding, 10)

```


## at least two functions each: one table verb and two table verb  (2 points)

Combine master into batting and into fielding.

```{r}
# Join master list into the batting list to show the players name.
batting_full <- left_join(batting, master_name, join = "playerID")

# Join master list into the fielding list to show players name.
fielding_full <- left_join(fielding, master_name, join = "playerID")

#player_data <- batting_full %>%
#  full_join(fielding, by = "playerID")

#tail(batting_full, 10 )
#tail(fielding_full, 10)

ls(fielding_full)
```

## Change column names
```{r warning=FALSE}
# Change the names of columns


fielding_full <- fielding_full %>%
  rename( 
    Year = yearID, 
    Team = teamID,
    League = lgID)


batting_full <- batting_full %>%
  rename( 
    Year = yearID, 
    Team = teamID,
    League = lgID
    
    )


```

```{r}





# Create an Batting Average variable
batting_full <- batting_full %>%
  mutate(Avg. = H / AB)

fielding_full <- relocate(fielding_full, playerID, nameFirst, nameLast, bats, birthCountry)

batting_full <- relocate(batting_full,  playerID, nameFirst, nameLast, bats, birthCountry )

batting_full <- relocate(batting_full, Avg., .after = G)

batting_full

colnames(batting_full)
colnames(fielding_full)

```

## Missing Values

Replace all NA values with 0.

This is the only use for a 'Missing Values' action. The data is in a good format for working.

```{r}

batting_new <- batting_full %>%
  filter(Year %in% (2000:2015))

batting_new %>%
  replace_na( list(HR = 0, RBI= 0, SB = 0, CS = 0,  BB = 0,  SO = 0, IBB = 0, HBP  = 0, SH = 0, SF  = 0, GIDP = 0))

# Only consider modern era baseball 2000 - 2015 and break into American and National Leagues
fielding_new_AL <- fielding_full %>%
  filter(Year %in% (2000:2015), League == "AL")

fielding_new_NL <- fielding_full %>%
  filter(Year %in% (2000:2015), League == "NL")

batting_new_AL <- batting_full %>%
  filter(Year %in% (2000:2015), League == "AL")

batting_new_NL <- batting_full %>%
  filter(Year %in% (2000:2015), League == "NL")




```


## at least two functions each of Grouping and Vector functions (2 points)
Group by Year and by Team

```{r}
#Group_by

teambattingAL <- batting_new_AL %>%
  group_by(Team) %>%
  summarise(Total_HR = sum(HR))

yearbattingAL <- batting_new_AL %>%
  group_by(Year) %>%
  summarise(Total_HR = sum(HR))


teambattingNL <- batting_new_NL %>%
  group_by(Team) %>%
  summarise(Total_HR = sum(HR))

yearbattingNL <- batting_new_NL %>%
  group_by(Year) %>%
  summarise(Total_HR = sum(HR))


```

## Vector

Top 10 players with most hits between 2000 and 2015
```{r}
battingrange <- batting_new %>%
    select(nameFirst, nameLast, Team, Year, G, AB, H, Avg., HR, BB, SO) %>%
  arrange(desc(H))

battingrange <- battingrange %>%
  mutate(Name = paste(nameFirst, nameLast, sep = " ")) %>%
  relocate(Name)

battingrange <- battingrange %>%
  slice(1:10) %>%
    select(Name, Team, Year, G, AB, H, Avg., HR, BB, SO) %>%
  arrange(desc(H))
  
  
  
ggplot(battingrange, aes(x = Name, y = H, color = Year, fill = Team)) +
  geom_col()

```


Number of games between 121 and 162

```{r}


batting_games <- filter(batting_new, between( G , 121, 162)) %>%
  select(nameFirst, nameLast, Team, Year, G, AB, H, Avg., HR, BB, SO) %>%
  arrange(desc(G))



batting_games %>% 
  count(Team)

head(batting_games, 10)

## ggplot using Teams and count for players that played full seasons, use color as year
ggplot(batting_games, aes(y = Team)) +
  geom_bar(width=1, position = position_dodge(width=1.5)) +
  xlab("Number of Players")
  
```


##  Pivoting

For this data, I did not find a useful way to pivot the data. The data is already organized in the way I would use it.

```{r}
batting_games %>%
  pivot_wider(names_from = Team, values_from = c(AB, H))
```



## at narrative discussing what you find interesting along with any issues you might have had creating this blog (2 points)
